var Nt=typeof global=="object"&&global&&global.Object===Object&&global,ae=typeof self=="object"&&self&&self.Object===Object&&self,h=Nt||ae||Function("return this")(),w=h.Symbol,Dt=Object.prototype,ce=Dt.hasOwnProperty,le=Dt.toString,C=w?w.toStringTag:void 0;function ue(t){var e=ce.call(t,C),r=t[C];try{t[C]=void 0;var n=!0}catch{}var o=le.call(t);return n&&(e?t[C]=r:delete t[C]),o}var fe=Object.prototype,pe=fe.toString;function de(t){return pe.call(t)}var he="[object Null]",ge="[object Undefined]",ct=w?w.toStringTag:void 0;function $(t){return t==null?t===void 0?ge:he:ct&&ct in Object(t)?ue(t):de(t)}function m(t){return t!=null&&typeof t=="object"}var ye="[object Symbol]";function Q(t){return typeof t=="symbol"||m(t)&&$(t)==ye}function be(t,e){for(var r=-1,n=t==null?0:t.length,o=Array(n);++r<n;)o[r]=e(t[r],r,t);return o}var y=Array.isArray,lt=w?w.prototype:void 0,ut=lt?lt.toString:void 0;function Rt(t){if(typeof t=="string")return t;if(y(t))return be(t,Rt)+"";if(Q(t))return ut?ut.call(t):"";var e=t+"";return e=="0"&&1/t==-1/0?"-0":e}function O(t){var e=typeof t;return t!=null&&(e=="object"||e=="function")}function Gt(t){return t}var ve="[object AsyncFunction]",we="[object Function]",me="[object GeneratorFunction]",Oe="[object Proxy]";function k(t){if(!O(t))return!1;var e=$(t);return e==we||e==me||e==ve||e==Oe}var W=h["__core-js_shared__"],ft=function(){var t=/[^.]+$/.exec(W&&W.keys&&W.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""}();function Te(t){return!!ft&&ft in t}var _e=Function.prototype,Se=_e.toString;function A(t){if(t!=null){try{return Se.call(t)}catch{}try{return t+""}catch{}}return""}var $e=/[\\^$.*+?()[\]{}|]/g,Ae=/^\[object .+?Constructor\]$/,Ee=Function.prototype,je=Object.prototype,Ie=Ee.toString,Me=je.hasOwnProperty,Pe=RegExp("^"+Ie.call(Me).replace($e,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function Ce(t){if(!O(t)||Te(t))return!1;var e=k(t)?Pe:Ae;return e.test(A(t))}function xe(t,e){return t==null?void 0:t[e]}function E(t,e){var r=xe(t,e);return Ce(r)?r:void 0}var V=E(h,"WeakMap"),pt=Object.create,Le=function(){function t(){}return function(e){if(!O(e))return{};if(pt)return pt(e);t.prototype=e;var r=new t;return t.prototype=void 0,r}}();function Ne(t,e,r){switch(r.length){case 0:return t.call(e);case 1:return t.call(e,r[0]);case 2:return t.call(e,r[0],r[1]);case 3:return t.call(e,r[0],r[1],r[2])}return t.apply(e,r)}function De(t,e){var r=-1,n=t.length;for(e||(e=Array(n));++r<n;)e[r]=t[r];return e}var Re=800,Ge=16,Fe=Date.now;function Ue(t){var e=0,r=0;return function(){var n=Fe(),o=Ge-(n-r);if(r=n,o>0){if(++e>=Re)return arguments[0]}else e=0;return t.apply(void 0,arguments)}}function He(t){return function(){return t}}var G=function(){try{var t=E(Object,"defineProperty");return t({},"",{}),t}catch{}}(),ze=G?function(t,e){return G(t,"toString",{configurable:!0,enumerable:!1,value:He(e),writable:!0})}:Gt,Be=Ue(ze);function We(t,e){for(var r=-1,n=t==null?0:t.length;++r<n&&e(t[r],r,t)!==!1;);return t}var Ke=9007199254740991,Ve=/^(?:0|[1-9]\d*)$/;function tt(t,e){var r=typeof t;return e=e??Ke,!!e&&(r=="number"||r!="symbol"&&Ve.test(t))&&t>-1&&t%1==0&&t<e}function et(t,e,r){e=="__proto__"&&G?G(t,e,{configurable:!0,enumerable:!0,value:r,writable:!0}):t[e]=r}function U(t,e){return t===e||t!==t&&e!==e}var qe=Object.prototype,Xe=qe.hasOwnProperty;function Ft(t,e,r){var n=t[e];(!(Xe.call(t,e)&&U(n,r))||r===void 0&&!(e in t))&&et(t,e,r)}function Je(t,e,r,n){var o=!r;r||(r={});for(var i=-1,s=e.length;++i<s;){var a=e[i],c=void 0;c===void 0&&(c=t[a]),o?et(r,a,c):Ft(r,a,c)}return r}var dt=Math.max;function Ze(t,e,r){return e=dt(e===void 0?t.length-1:e,0),function(){for(var n=arguments,o=-1,i=dt(n.length-e,0),s=Array(i);++o<i;)s[o]=n[e+o];o=-1;for(var a=Array(e+1);++o<e;)a[o]=n[o];return a[e]=r(s),Ne(t,this,a)}}function Ye(t,e){return Be(Ze(t,e,Gt),t+"")}var Qe=9007199254740991;function rt(t){return typeof t=="number"&&t>-1&&t%1==0&&t<=Qe}function H(t){return t!=null&&rt(t.length)&&!k(t)}function ke(t,e,r){if(!O(r))return!1;var n=typeof e;return(n=="number"?H(r)&&tt(e,r.length):n=="string"&&e in r)?U(r[e],t):!1}function tr(t){return Ye(function(e,r){var n=-1,o=r.length,i=o>1?r[o-1]:void 0,s=o>2?r[2]:void 0;for(i=t.length>3&&typeof i=="function"?(o--,i):void 0,s&&ke(r[0],r[1],s)&&(i=o<3?void 0:i,o=1),e=Object(e);++n<o;){var a=r[n];a&&t(e,a,n,i)}return e})}var er=Object.prototype;function nt(t){var e=t&&t.constructor,r=typeof e=="function"&&e.prototype||er;return t===r}function rr(t,e){for(var r=-1,n=Array(t);++r<t;)n[r]=e(r);return n}var nr="[object Arguments]";function ht(t){return m(t)&&$(t)==nr}var Ut=Object.prototype,or=Ut.hasOwnProperty,ir=Ut.propertyIsEnumerable,F=ht(function(){return arguments}())?ht:function(t){return m(t)&&or.call(t,"callee")&&!ir.call(t,"callee")};function sr(){return!1}var Ht=typeof exports=="object"&&exports&&!exports.nodeType&&exports,gt=Ht&&typeof module=="object"&&module&&!module.nodeType&&module,ar=gt&&gt.exports===Ht,yt=ar?h.Buffer:void 0,cr=yt?yt.isBuffer:void 0,ot=cr||sr,lr="[object Arguments]",ur="[object Array]",fr="[object Boolean]",pr="[object Date]",dr="[object Error]",hr="[object Function]",gr="[object Map]",yr="[object Number]",br="[object Object]",vr="[object RegExp]",wr="[object Set]",mr="[object String]",Or="[object WeakMap]",Tr="[object ArrayBuffer]",_r="[object DataView]",Sr="[object Float32Array]",$r="[object Float64Array]",Ar="[object Int8Array]",Er="[object Int16Array]",jr="[object Int32Array]",Ir="[object Uint8Array]",Mr="[object Uint8ClampedArray]",Pr="[object Uint16Array]",Cr="[object Uint32Array]",u={};u[Sr]=u[$r]=u[Ar]=u[Er]=u[jr]=u[Ir]=u[Mr]=u[Pr]=u[Cr]=!0;u[lr]=u[ur]=u[Tr]=u[fr]=u[_r]=u[pr]=u[dr]=u[hr]=u[gr]=u[yr]=u[br]=u[vr]=u[wr]=u[mr]=u[Or]=!1;function xr(t){return m(t)&&rt(t.length)&&!!u[$(t)]}function it(t){return function(e){return t(e)}}var zt=typeof exports=="object"&&exports&&!exports.nodeType&&exports,x=zt&&typeof module=="object"&&module&&!module.nodeType&&module,Lr=x&&x.exports===zt,K=Lr&&Nt.process,M=function(){try{var t=x&&x.require&&x.require("util").types;return t||K&&K.binding&&K.binding("util")}catch{}}(),bt=M&&M.isTypedArray,Bt=bt?it(bt):xr,Nr=Object.prototype,Dr=Nr.hasOwnProperty;function Wt(t,e){var r=y(t),n=!r&&F(t),o=!r&&!n&&ot(t),i=!r&&!n&&!o&&Bt(t),s=r||n||o||i,a=s?rr(t.length,String):[],c=a.length;for(var f in t)(e||Dr.call(t,f))&&!(s&&(f=="length"||o&&(f=="offset"||f=="parent")||i&&(f=="buffer"||f=="byteLength"||f=="byteOffset")||tt(f,c)))&&a.push(f);return a}function Kt(t,e){return function(r){return t(e(r))}}var Rr=Kt(Object.keys,Object),Gr=Object.prototype,Fr=Gr.hasOwnProperty;function Ur(t){if(!nt(t))return Rr(t);var e=[];for(var r in Object(t))Fr.call(t,r)&&r!="constructor"&&e.push(r);return e}function Hr(t){return H(t)?Wt(t):Ur(t)}function zr(t){var e=[];if(t!=null)for(var r in Object(t))e.push(r);return e}var Br=Object.prototype,Wr=Br.hasOwnProperty;function Kr(t){if(!O(t))return zr(t);var e=nt(t),r=[];for(var n in t)n=="constructor"&&(e||!Wr.call(t,n))||r.push(n);return r}function Vt(t){return H(t)?Wt(t,!0):Kr(t)}var Vr=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,qr=/^\w*$/;function Xr(t,e){if(y(t))return!1;var r=typeof t;return r=="number"||r=="symbol"||r=="boolean"||t==null||Q(t)?!0:qr.test(t)||!Vr.test(t)||e!=null&&t in Object(e)}var L=E(Object,"create");function Jr(){this.__data__=L?L(null):{},this.size=0}function Zr(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e}var Yr="__lodash_hash_undefined__",Qr=Object.prototype,kr=Qr.hasOwnProperty;function tn(t){var e=this.__data__;if(L){var r=e[t];return r===Yr?void 0:r}return kr.call(e,t)?e[t]:void 0}var en=Object.prototype,rn=en.hasOwnProperty;function nn(t){var e=this.__data__;return L?e[t]!==void 0:rn.call(e,t)}var on="__lodash_hash_undefined__";function sn(t,e){var r=this.__data__;return this.size+=this.has(t)?0:1,r[t]=L&&e===void 0?on:e,this}function S(t){var e=-1,r=t==null?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}S.prototype.clear=Jr;S.prototype.delete=Zr;S.prototype.get=tn;S.prototype.has=nn;S.prototype.set=sn;function an(){this.__data__=[],this.size=0}function z(t,e){for(var r=t.length;r--;)if(U(t[r][0],e))return r;return-1}var cn=Array.prototype,ln=cn.splice;function un(t){var e=this.__data__,r=z(e,t);if(r<0)return!1;var n=e.length-1;return r==n?e.pop():ln.call(e,r,1),--this.size,!0}function fn(t){var e=this.__data__,r=z(e,t);return r<0?void 0:e[r][1]}function pn(t){return z(this.__data__,t)>-1}function dn(t,e){var r=this.__data__,n=z(r,t);return n<0?(++this.size,r.push([t,e])):r[n][1]=e,this}function b(t){var e=-1,r=t==null?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}b.prototype.clear=an;b.prototype.delete=un;b.prototype.get=fn;b.prototype.has=pn;b.prototype.set=dn;var N=E(h,"Map");function hn(){this.size=0,this.__data__={hash:new S,map:new(N||b),string:new S}}function gn(t){var e=typeof t;return e=="string"||e=="number"||e=="symbol"||e=="boolean"?t!=="__proto__":t===null}function B(t,e){var r=t.__data__;return gn(e)?r[typeof e=="string"?"string":"hash"]:r.map}function yn(t){var e=B(this,t).delete(t);return this.size-=e?1:0,e}function bn(t){return B(this,t).get(t)}function vn(t){return B(this,t).has(t)}function wn(t,e){var r=B(this,t),n=r.size;return r.set(t,e),this.size+=r.size==n?0:1,this}function T(t){var e=-1,r=t==null?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}T.prototype.clear=hn;T.prototype.delete=yn;T.prototype.get=bn;T.prototype.has=vn;T.prototype.set=wn;var mn="Expected a function";function st(t,e){if(typeof t!="function"||e!=null&&typeof e!="function")throw new TypeError(mn);var r=function(){var n=arguments,o=e?e.apply(this,n):n[0],i=r.cache;if(i.has(o))return i.get(o);var s=t.apply(this,n);return r.cache=i.set(o,s)||i,s};return r.cache=new(st.Cache||T),r}st.Cache=T;var On=500;function Tn(t){var e=st(t,function(n){return r.size===On&&r.clear(),n}),r=e.cache;return e}var _n=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Sn=/\\(\\)?/g,$n=Tn(function(t){var e=[];return t.charCodeAt(0)===46&&e.push(""),t.replace(_n,function(r,n,o,i){e.push(o?i.replace(Sn,"$1"):n||r)}),e});function An(t){return t==null?"":Rt(t)}function qt(t,e){return y(t)?t:Xr(t,e)?[t]:$n(An(t))}function Xt(t){if(typeof t=="string"||Q(t))return t;var e=t+"";return e=="0"&&1/t==-1/0?"-0":e}function En(t,e){e=qt(e,t);for(var r=0,n=e.length;t!=null&&r<n;)t=t[Xt(e[r++])];return r&&r==n?t:void 0}function vt(t,e,r){var n=t==null?void 0:En(t,e);return n===void 0?r:n}function jn(t,e){for(var r=-1,n=e.length,o=t.length;++r<n;)t[o+r]=e[r];return t}var Jt=Kt(Object.getPrototypeOf,Object),In="[object Object]",Mn=Function.prototype,Pn=Object.prototype,Zt=Mn.toString,Cn=Pn.hasOwnProperty,xn=Zt.call(Object);function Ln(t){if(!m(t)||$(t)!=In)return!1;var e=Jt(t);if(e===null)return!0;var r=Cn.call(e,"constructor")&&e.constructor;return typeof r=="function"&&r instanceof r&&Zt.call(r)==xn}function Nn(){this.__data__=new b,this.size=0}function Dn(t){var e=this.__data__,r=e.delete(t);return this.size=e.size,r}function Rn(t){return this.__data__.get(t)}function Gn(t){return this.__data__.has(t)}var Fn=200;function Un(t,e){var r=this.__data__;if(r instanceof b){var n=r.__data__;if(!N||n.length<Fn-1)return n.push([t,e]),this.size=++r.size,this;r=this.__data__=new T(n)}return r.set(t,e),this.size=r.size,this}function j(t){var e=this.__data__=new b(t);this.size=e.size}j.prototype.clear=Nn;j.prototype.delete=Dn;j.prototype.get=Rn;j.prototype.has=Gn;j.prototype.set=Un;var Yt=typeof exports=="object"&&exports&&!exports.nodeType&&exports,wt=Yt&&typeof module=="object"&&module&&!module.nodeType&&module,Hn=wt&&wt.exports===Yt,mt=Hn?h.Buffer:void 0,Ot=mt?mt.allocUnsafe:void 0;function Qt(t,e){if(e)return t.slice();var r=t.length,n=Ot?Ot(r):new t.constructor(r);return t.copy(n),n}function zn(t,e){for(var r=-1,n=t==null?0:t.length,o=0,i=[];++r<n;){var s=t[r];e(s,r,t)&&(i[o++]=s)}return i}function Bn(){return[]}var Wn=Object.prototype,Kn=Wn.propertyIsEnumerable,Tt=Object.getOwnPropertySymbols,Vn=Tt?function(t){return t==null?[]:(t=Object(t),zn(Tt(t),function(e){return Kn.call(t,e)}))}:Bn;function qn(t,e,r){var n=e(t);return y(t)?n:jn(n,r(t))}function Xn(t){return qn(t,Hr,Vn)}var q=E(h,"DataView"),X=E(h,"Promise"),J=E(h,"Set"),_t="[object Map]",Jn="[object Object]",St="[object Promise]",$t="[object Set]",At="[object WeakMap]",Et="[object DataView]",Zn=A(q),Yn=A(N),Qn=A(X),kn=A(J),to=A(V),g=$;(q&&g(new q(new ArrayBuffer(1)))!=Et||N&&g(new N)!=_t||X&&g(X.resolve())!=St||J&&g(new J)!=$t||V&&g(new V)!=At)&&(g=function(t){var e=$(t),r=e==Jn?t.constructor:void 0,n=r?A(r):"";if(n)switch(n){case Zn:return Et;case Yn:return _t;case Qn:return St;case kn:return $t;case to:return At}return e});var eo=Object.prototype,ro=eo.hasOwnProperty;function no(t){var e=t.length,r=new t.constructor(e);return e&&typeof t[0]=="string"&&ro.call(t,"index")&&(r.index=t.index,r.input=t.input),r}var jt=h.Uint8Array;function at(t){var e=new t.constructor(t.byteLength);return new jt(e).set(new jt(t)),e}function oo(t,e){var r=at(t.buffer);return new t.constructor(r,t.byteOffset,t.byteLength)}var io=/\w*$/;function so(t){var e=new t.constructor(t.source,io.exec(t));return e.lastIndex=t.lastIndex,e}var It=w?w.prototype:void 0,Mt=It?It.valueOf:void 0;function ao(t){return Mt?Object(Mt.call(t)):{}}function kt(t,e){var r=e?at(t.buffer):t.buffer;return new t.constructor(r,t.byteOffset,t.length)}var co="[object Boolean]",lo="[object Date]",uo="[object Map]",fo="[object Number]",po="[object RegExp]",ho="[object Set]",go="[object String]",yo="[object Symbol]",bo="[object ArrayBuffer]",vo="[object DataView]",wo="[object Float32Array]",mo="[object Float64Array]",Oo="[object Int8Array]",To="[object Int16Array]",_o="[object Int32Array]",So="[object Uint8Array]",$o="[object Uint8ClampedArray]",Ao="[object Uint16Array]",Eo="[object Uint32Array]";function jo(t,e,r){var n=t.constructor;switch(e){case bo:return at(t);case co:case lo:return new n(+t);case vo:return oo(t);case wo:case mo:case Oo:case To:case _o:case So:case $o:case Ao:case Eo:return kt(t,r);case uo:return new n;case fo:case go:return new n(t);case po:return so(t);case ho:return new n;case yo:return ao(t)}}function te(t){return typeof t.constructor=="function"&&!nt(t)?Le(Jt(t)):{}}var Io="[object Map]";function Mo(t){return m(t)&&g(t)==Io}var Pt=M&&M.isMap,Po=Pt?it(Pt):Mo,Co="[object Set]";function xo(t){return m(t)&&g(t)==Co}var Ct=M&&M.isSet,Lo=Ct?it(Ct):xo,No=1,ee="[object Arguments]",Do="[object Array]",Ro="[object Boolean]",Go="[object Date]",Fo="[object Error]",re="[object Function]",Uo="[object GeneratorFunction]",Ho="[object Map]",zo="[object Number]",ne="[object Object]",Bo="[object RegExp]",Wo="[object Set]",Ko="[object String]",Vo="[object Symbol]",qo="[object WeakMap]",Xo="[object ArrayBuffer]",Jo="[object DataView]",Zo="[object Float32Array]",Yo="[object Float64Array]",Qo="[object Int8Array]",ko="[object Int16Array]",ti="[object Int32Array]",ei="[object Uint8Array]",ri="[object Uint8ClampedArray]",ni="[object Uint16Array]",oi="[object Uint32Array]",l={};l[ee]=l[Do]=l[Xo]=l[Jo]=l[Ro]=l[Go]=l[Zo]=l[Yo]=l[Qo]=l[ko]=l[ti]=l[Ho]=l[zo]=l[ne]=l[Bo]=l[Wo]=l[Ko]=l[Vo]=l[ei]=l[ri]=l[ni]=l[oi]=!0;l[Fo]=l[re]=l[qo]=!1;function R(t,e,r,n,o,i){var s,a=e&No;if(s!==void 0)return s;if(!O(t))return t;var c=y(t);if(c)s=no(t);else{var f=g(t),p=f==re||f==Uo;if(ot(t))return Qt(t,a);if(f==ne||f==ee||p&&!o)s=p?{}:te(t);else{if(!l[f])return o?t:{};s=jo(t,f,a)}}i||(i=new j);var v=i.get(t);if(v)return v;i.set(t,s),Lo(t)?t.forEach(function(d){s.add(R(d,e,r,d,t,i))}):Po(t)&&t.forEach(function(d,_){s.set(_,R(d,e,r,_,t,i))});var P=Xn,I=c?void 0:P(t);return We(I||t,function(d,_){I&&(_=d,d=t[_]),Ft(s,_,R(d,e,r,_,t,i))}),s}var ii=1,si=4;function D(t){return R(t,ii|si)}function ai(t,e,r){e=qt(e,t);for(var n=-1,o=e.length,i=!1;++n<o;){var s=Xt(e[n]);if(!(i=t!=null&&r(t,s)))break;t=t[s]}return i||++n!=o?i:(o=t==null?0:t.length,!!o&&rt(o)&&tt(s,o)&&(y(t)||F(t)))}function ci(t){return function(e,r,n){for(var o=-1,i=Object(e),s=n(e),a=s.length;a--;){var c=s[++o];if(r(i[c],c,i)===!1)break}return e}}var li=ci();function Z(t,e,r){(r!==void 0&&!U(t[e],r)||r===void 0&&!(e in t))&&et(t,e,r)}function ui(t){return m(t)&&H(t)}function Y(t,e){if(!(e==="constructor"&&typeof t[e]=="function")&&e!="__proto__")return t[e]}function fi(t){return Je(t,Vt(t))}function pi(t,e,r,n,o,i,s){var a=Y(t,r),c=Y(e,r),f=s.get(c);if(f){Z(t,r,f);return}var p=i?i(a,c,r+"",t,e,s):void 0,v=p===void 0;if(v){var P=y(c),I=!P&&ot(c),d=!P&&!I&&Bt(c);p=c,P||I||d?y(a)?p=a:ui(a)?p=De(a):I?(v=!1,p=Qt(c,!0)):d?(v=!1,p=kt(c,!0)):p=[]:Ln(c)||F(c)?(p=a,F(a)?p=fi(a):(!O(a)||k(a))&&(p=te(c))):v=!1}v&&(s.set(c,p),o(p,c,n,i,s),s.delete(c)),Z(t,r,p)}function oe(t,e,r,n,o){t!==e&&li(e,function(i,s){if(o||(o=new j),O(i))pi(t,e,s,r,oe,n,o);else{var a=n?n(Y(t,s),i,s+"",t,e,o):void 0;a===void 0&&(a=i),Z(t,s,a)}},Vt)}var xt=tr(function(t,e,r,n){oe(t,e,r,n)}),di=Object.prototype,hi=di.hasOwnProperty;function gi(t,e){return t!=null&&hi.call(t,e)}function Lt(t,e){return t!=null&&ai(t,e,gi)}class ie{constructor(e,r){this.utilityName=e,this.defaultOptions=D(r),this.options=D(r)}resetOptions(){this.options=D(this.defaultOptions)}setOption(e,r){if(typeof e=="object"&&e!==null&&r===void 0)this.options=xt({},this.options,e,(n,o)=>{if(o===void 0)return n;if(Array.isArray(o))return o});else if(typeof e=="string"||typeof e=="symbol"){if(r===void 0)return;this.options=xt({},this.options,{[e]:r},(n,o)=>{if(o===void 0)return n;if(Array.isArray(o))return o})}}getOption(e,r){if(e===void 0)return D(this.options);if(r!==void 0){const n=this.options[e];return vt(n,r)}return typeof e=="string"&&e.includes(".")?vt(this.options,e):this.options[e]}hasOption(e,r){if(r!==void 0){const n=this.options[e];return n!==void 0&&Lt(n,r)}return typeof e=="string"&&e.includes(".")?Lt(this.options,e):this.options[e]!==void 0}getUtilityName(){return this.utilityName}setOptions(e){this.setOption(e)}getOptions(){return this.getOption()}}class yi{constructor(){this.managers=new Map}registerManager(e,r){this.managers.set(e,r)}setGlobalOptions(e){for(const[r,n]of Object.entries(e)){const o=this.managers.get(r);o&&n&&o.setOption(n)}}getAllOptions(){const e={};for(const[r,n]of this.managers.entries())e[r]=n.getOption();return e}resetAllOptions(){for(const e of this.managers.values())e.resetOptions()}getManager(e){return this.managers.get(e)}getRegisteredUtilities(){return Array.from(this.managers.keys())}}const se=new yi,bi={log:console.log.bind(console),info:console.info.bind(console),warn:console.warn.bind(console),error:console.error.bind(console),debug:console.debug.bind(console)};class vi{constructor(){this.isProduction=this.detectProductionMode(),this.interceptors=[];const e={type:this.detectEnvironment(),showCaller:!0,client:{namespace:"client",production:[],localStorageOverrideKey:"logLevels",attachWindow:!0},server:{namespace:"server",production:["error"]},interceptor:void 0};this.optionsManager=new ie("log",e),se.registerManager("log",this.optionsManager),this.ORIGINAL_CONSOLE_METHODS=bi,this.log=this.log.bind(this),this.info=this.info.bind(this),this.warn=this.warn.bind(this),this.error=this.error.bind(this),this.debug=this.debug.bind(this),this.options.type==="client"&&this.options.client.attachWindow&&(globalThis.log=this)}get options(){return this.optionsManager.getOption()}detectEnvironment(){return typeof window<"u"&&typeof document<"u"?"client":typeof globalThis.process<"u"&&globalThis.process.versions&&globalThis.process.versions.node?"server":"client"}detectProductionMode(){return typeof window<"u"||typeof globalThis.process<"u"}getLocalStorageOverride(){const e=this.options;if(e.type!=="client"||typeof localStorage>"u")return null;try{const r=localStorage.getItem(e.client.localStorageOverrideKey);return r?r==="true"?!0:JSON.parse(r):null}catch{return null}}getCallerInfo(){try{const e=new Error().stack;if(!e)return null;const r=e.split(`
`);for(let n=4;n<r.length;n++){const o=r[n];if(o&&!o.includes("log.ts")&&!o.includes("log.js")){const i=o.match(/\((.*?):\d+:\d+\)|at (.*?):\d+:\d+/);if(i){const s=i[1]||i[2];if(s)return s.split("/").pop()||s}}}}catch{}return null}shouldLog(e){var o;const r=this.options,n=r[r.type];if(!this.isProduction)return!0;if(r.type==="client"){const i=this.getLocalStorageOverride();if(i===!0||Array.isArray(i)&&i.includes(e))return!0}return((o=n.production)==null?void 0:o.includes(e))??!1}formatMessage(e,r){const n=this.options,o=n[n.type];new Date().toISOString(),o.namespace;const i=n.showCaller?this.getCallerInfo():null;return i?[`[${i}]`,...r]:r}_log(e,r){const n=this.options;if(n.interceptor)try{n.interceptor(e,r)}catch(s){this.ORIGINAL_CONSOLE_METHODS.error("Log interceptor error:",s)}for(const s of this.interceptors)try{s(e,r)}catch(a){this.ORIGINAL_CONSOLE_METHODS.error("Log interceptor error:",a)}if(!this.shouldLog(e))return;const o=this.formatMessage(e,r);this.isTestEnvironment()?(console[e]||console.log)(...o):(this.ORIGINAL_CONSOLE_METHODS[e]||this.ORIGINAL_CONSOLE_METHODS.log)(...o)}isTestEnvironment(){if(typeof global<"u"&&global.expect&&global.describe&&global.it)return!0;if(typeof window>"u"&&(typeof global<"u"||typeof globalThis<"u")){const e=typeof global<"u"?global:globalThis;if(e.__coverage__||e.jasmine||e.mocha)return!0}return!1}setOptions(e){this.optionsManager.setOption(e)}getOptions(){return this.optionsManager.getOption()}log(...e){this._log("log",e)}info(...e){this._log("info",e)}warn(...e){this._log("warn",e)}error(...e){this._log("error",e)}debug(...e){this._log("debug",e)}enableDebug(e=!0){const r=this.options;if(r.type==="client")if(typeof localStorage<"u"){const n=e===!0?"true":JSON.stringify(e);localStorage.setItem(r.client.localStorageOverrideKey,n),this.ORIGINAL_CONSOLE_METHODS.info("Debug mode enabled. Refresh page to see all logs.")}else this.ORIGINAL_CONSOLE_METHODS.warn("localStorage not available, cannot enable debug mode.");else this.ORIGINAL_CONSOLE_METHODS.warn("enableDebug only works on client-side")}disableDebug(){const e=this.options;e.type==="client"?typeof localStorage<"u"?(localStorage.removeItem(e.client.localStorageOverrideKey),this.ORIGINAL_CONSOLE_METHODS.info("Debug mode disabled. Refresh page to restore production log levels.")):this.ORIGINAL_CONSOLE_METHODS.warn("localStorage not available, cannot disable debug mode."):this.ORIGINAL_CONSOLE_METHODS.warn("disableDebug only works on client-side")}addInterceptor(e){typeof e=="function"&&this.interceptors.push(e)}removeInterceptor(e){const r=this.interceptors.indexOf(e);r!==-1&&this.interceptors.splice(r,1)}}const mi=new vi;class wi{constructor(){this.widgetIds=new Set,this.scriptLoaded=!1,this.scriptLoading=!1;const e={environment:this.detectEnvironment(),apiUrl:"https://challenges.cloudflare.com/turnstile/v0/siteverify",scriptUrl:"https://challenges.cloudflare.com/turnstile/v0/api.js",widget:{theme:"auto",size:"normal",retry:"auto","retry-interval":8e3,"refresh-expired":"auto",appearance:"always","response-field":!0,"response-field-name":"cf-turnstile-response"},siteKey:void 0,secretKey:void 0,interceptor:void 0};this.optionsManager=new ie("turnstile",e),se.registerManager("turnstile",this.optionsManager),this.render=this.render.bind(this),this.verify=this.verify.bind(this),this.reset=this.reset.bind(this),this.remove=this.remove.bind(this)}get options(){return this.optionsManager.getOption()}detectEnvironment(){var e,r;return typeof window<"u"&&typeof document<"u"?"client":typeof globalThis<"u"&&((r=(e=globalThis.process)==null?void 0:e.versions)!=null&&r.node)?"server":"client"}async loadScript(){const e=this.options;if(e.environment!=="client")throw new Error("Script loading is only available on client-side");return this.scriptLoaded?Promise.resolve():this.scriptLoading?new Promise(r=>{const n=()=>{this.scriptLoaded?r():setTimeout(n,50)};n()}):(this.scriptLoading=!0,new Promise((r,n)=>{const o=document.createElement("script");o.src=e.scriptUrl,o.onload=()=>{this.scriptLoaded=!0,this.scriptLoading=!1,r()},o.onerror=()=>{this.scriptLoading=!1,n(new Error("Failed to load Turnstile script"))},document.head.appendChild(o)}))}callInterceptor(e,r){const n=this.options;if(n.interceptor)try{n.interceptor(e,r)}catch(o){console.error("Turnstile interceptor error:",o)}}setOptions(e){this.optionsManager.setOption(e)}resetOptions(){this.optionsManager.resetOptions()}getOptions(){return this.optionsManager.getOption()}async render(e,r={}){const n=this.options;if(n.environment!=="client")throw new Error("Widget rendering is only available on client-side");if(!n.siteKey)throw new Error('Site key is required. Call turnstile.setOptions({ siteKey: "your-key" }) first.');return this.callInterceptor("render-start",{container:e,customOptions:r}),await this.loadScript(),new Promise((o,i)=>{const s=()=>{try{const a={sitekey:n.siteKey,...n.widget,...r},c=window.turnstile.render(e,a);this.widgetIds.add(c),this.callInterceptor("render-success",{container:e,widgetId:c,options:a}),o(c)}catch(a){this.callInterceptor("render-error",{container:e,error:a}),i(a)}};window.turnstile,s()})}getResponse(e){if(this.options.environment!=="client")throw new Error("Getting response is only available on client-side");if(!window.turnstile)throw new Error("Turnstile script not loaded");const n=window.turnstile.getResponse(e);return this.callInterceptor("get-response",{widgetId:e,response:n}),n}reset(e){if(this.options.environment!=="client")throw new Error("Widget reset is only available on client-side");if(!window.turnstile)throw new Error("Turnstile script not loaded");window.turnstile.reset(e),this.callInterceptor("reset",{widgetId:e})}remove(e){if(this.options.environment!=="client")throw new Error("Widget removal is only available on client-side");if(!window.turnstile)throw new Error("Turnstile script not loaded");window.turnstile.remove(e),this.widgetIds.delete(e),this.callInterceptor("remove",{widgetId:e})}isExpired(e){if(this.options.environment!=="client")throw new Error("Widget expiry check is only available on client-side");if(!window.turnstile)throw new Error("Turnstile script not loaded");const n=window.turnstile.isExpired(e);return this.callInterceptor("is-expired",{widgetId:e,expired:n}),n}async verify(e,r){const n=this.options;if(n.environment!=="server")throw new Error("Token verification is only available on server-side");if(!n.secretKey)throw new Error('Secret key is required. Call turnstile.setOptions({ secretKey: "your-key" }) first.');this.callInterceptor("verify-start",{token:e,remoteip:r});const o=new URLSearchParams;o.append("secret",n.secretKey),o.append("response",e),r&&o.append("remoteip",r);try{const i=await fetch(n.apiUrl,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:o});if(!i.ok)throw new Error(`HTTP error! status: ${i.status}`);const s=await i.json();return this.callInterceptor("verify-complete",{token:e,remoteip:r,result:s}),s}catch(i){throw this.callInterceptor("verify-error",{token:e,remoteip:r,error:i}),i}}getActiveWidgets(){return Array.from(this.widgetIds)}removeAll(){if(this.options.environment!=="client")throw new Error("Widget removal is only available on client-side");const r=Array.from(this.widgetIds);for(const n of r)this.remove(n)}cleanup(){this.options.environment==="client"&&this.removeAll()}}const Oi=new wi;export{vi as Log,bi as ORIGINAL_CONSOLE_METHODS,ie as OptionsManager,wi as Turnstile,mi as log,se as optionsManager,Oi as turnstile};
//# sourceMappingURL=index-B9j-2y84.js.map
